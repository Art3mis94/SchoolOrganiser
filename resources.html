<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educator Hub - Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Consolidated Application Styles -->
    <style>
        /* ====================================== */
        /* APPLICATION-WIDE COMPONENT STYLES      */
        /* ====================================== */
        .nav-active {
            @apply bg-white text-indigo-700 shadow-inner;
        }
        .tab-active {
            @apply bg-white border-b-2 border-indigo-600 font-bold text-indigo-700;
        }
        .collapsible-header {
            @apply flex justify-between items-center cursor-pointer p-4 rounded-t-xl;
        }
        .drag-zone {
            border: 2px dashed #9ca3af;
            background-color: #f9fafb;
            text-align: center;
            padding: 20px;
            margin-top: 10px;
            border-radius: 8px;
            transition: all 0.2s;
        }
        .drag-over {
            border-color: #4f46e5;
            background-color: #eef2ff;
        }
        /* Custom utility tag for curriculum status */
        .topic-status-tag {
            padding: 0.25rem 0.6rem;
            border-radius: 9999px; 
            font-size: 0.75rem; 
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); 
        }
        /* Toggle button for curriculum expansion */
        .toggle-btn {
            @apply text-gray-600 hover:text-indigo-600 transition-transform duration-200;
        }
        .toggle-btn span:last-child {
            @apply transition-transform duration-200;
        }
        .toggle-btn.collapsed span:last-child {
            @apply rotate-0;
        }
        .toggle-btn:not(.collapsed) span:last-child {
            @apply rotate-90;
        }
        /* Curriculum Structure Styles (Topic/Lesson containers) */
        .topic {
            @apply flex flex-col gap-2;
        }
        .subtopics {
            @apply ml-6 mt-2 space-y-2;
        }
        .lesson-group {
            @apply mb-4;
        }
        .lesson {
            @apply p-4 bg-gray-50 rounded-lg shadow-sm hover:shadow-md transition;
        }
        .lesson h3 {
            @apply text-lg font-semibold text-gray-800;
        }
        .lesson p {
            @apply text-gray-600;
        }
        /* Completed item styles */
        .completed {
            @apply line-through text-gray-500;
        }
        /* Button defaults for the app */
        button {
            @apply transition duration-200;
        }
        .topic button {
            @apply transition duration-200 shadow-sm hover:shadow-md; 
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <nav class="bg-indigo-700 p-4 shadow-2xl">
        <div class="container max-w-4xl mx-auto flex flex-wrap justify-center gap-4">
            <a href="dashboard.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Home üè†</a>
            <a href="curriculum_topics.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Topics üß†</a>
            <a href="notes.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Notes üìù</a>
            <a href="todo.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">To-Do List ‚úÖ</a>
            <a href="resources.html" class="px-4 py-2 nav-active font-bold rounded-lg transition">Tools üõ†Ô∏è</a>
        </div>
    </nav>
    <div class="container max-w-4xl mx-auto p-8 bg-white rounded-3xl shadow-2xl mt-8 space-y-6">
        <h1 class="text-3xl font-bold text-center text-gray-800">Resources & Management Tools üõ†Ô∏è</h1>
        
        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="text-center text-gray-500 p-8">
            <i class="fa-solid fa-spinner fa-spin mr-2"></i> Initializing App & Loading Curriculum Data...
        </div>
        <div id="errorDisplay" class="hidden text-center text-red-600 p-4 bg-red-100 border border-red-300 rounded-lg font-medium"></div>
        <p id="userIdDisplay" class="text-xs text-gray-400 mt-4 text-center">User ID: N/A</p>

        <div class="flex border-b border-gray-300">
            <button id="tabTools" onclick="showTab('tools')" class="tab-active py-2 px-4 text-gray-600 hover:text-indigo-700 transition">Management Tools</button>
            <button id="tabFiles" onclick="showTab('files')" class="py-2 px-4 text-gray-600 hover:text-indigo-700 transition">View Resources & Files</button>
        </div>

        <div id="contentTools" class="space-y-6">
            
            <!-- Lesson Import Section -->
            <div id="sectionLessonImport" class="bg-green-50 border-l-4 border-green-500 rounded-xl shadow-lg">
                <div class="collapsible-header bg-green-100" onclick="toggleCollapse('contentLessonImport', 'iconLessonImport')">
                    <h2 class="text-xl font-bold text-green-700 flex items-center gap-3">
                        <i class="fa-solid fa-file-import"></i> Bulk Import: Lesson Resources
                    </h2>
                    <i id="iconLessonImport" class="fa-solid fa-caret-down text-green-700"></i>
                </div>
                <div id="contentLessonImport" class="p-6 pt-0 space-y-4">
                    <p class="text-green-600 mb-4">Paste multiple links/text resources **OR** drag and drop a file to be added to a specific lesson. (Requires curriculum data.)</p>
                    
                    <form id="lessonResourceImportForm" class="space-y-4">
                        <select id="importTopicSelect" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white" disabled>
                            <option value="">-- Select Parent Topic --</option>
                        </select>
                        
                        <select id="importLessonSelect" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 bg-white" disabled>
                            <option value="">-- Select Target Lesson --</option>
                        </select>

                        <textarea id="importResourcesText" placeholder="Paste text resources or links here (one per line)" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 resize-y min-h-[100px]"></textarea>
                        
                        <div id="fileLessonDropZone" class="drag-zone">
                            <p class="text-gray-500"><i class="fa-solid fa-file-circle-plus mr-2"></i> Drag and Drop File Attachment Here (Max 5MB)</p>
                            <input type="file" id="lessonFile" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt" class="hidden">
                        </div>
                        
                        <button type="submit" id="submitLessonImportBtn" class="w-full p-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition shadow-md" disabled>
                            <i class="fa-solid fa-cloud-arrow-up mr-2"></i> Import Resource(s)
                        </button>
                    </form>
                    <p id="importLessonMessage" class="mt-4 text-center font-semibold hidden"></p>
                </div>
            </div>

            <!-- General Import Section -->
            <div id="sectionGeneralImport" class="bg-indigo-50 border-l-4 border-indigo-500 rounded-xl shadow-lg">
                <div class="collapsible-header bg-indigo-100" onclick="toggleCollapse('contentGeneralImport', 'iconGeneralImport')">
                    <h2 class="text-xl font-bold text-indigo-700 flex items-center gap-3">
                        <i class="fa-solid fa-bookmark"></i> Quick Save: General Resources
                    </h2>
                    <i id="iconGeneralImport" class="fa-solid fa-caret-right text-indigo-700"></i>
                </div>
                <div id="contentGeneralImport" class="p-6 pt-0 space-y-4 hidden">
                    <p class="text-indigo-600 mb-4">Save a quick link, text resource, or drag and drop a file that isn't yet tied to a specific lesson. This data is cloud-synced.</p>
                    
                    <form id="generalResourceImportForm" class="space-y-4">
                        <textarea id="generalResourcesText" placeholder="Paste a general resource or link here" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-y min-h-[80px]"></textarea>

                        <div id="fileDropZone" class="drag-zone">
                            <p class="text-gray-500"><i class="fa-solid fa-cloud-arrow-up mr-2"></i> Drag and Drop File Here (Max 5MB)</p>
                            <input type="file" id="generalFile" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt" class="hidden">
                        </div>

                        <button type="submit" id="submitGeneralImportBtn" class="w-full p-3 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition shadow-md" disabled>
                            <i class="fa-solid fa-floppy-disk mr-2"></i> Save Resource
                        </button>
                    </form>
                    <p id="importGeneralMessage" class="mt-4 text-center font-semibold hidden"></p>
                </div>
            </div>
            
            <!-- Data Management Section -->
            <div id="sectionBackup" class="bg-yellow-50 border-l-4 border-yellow-500 rounded-xl shadow-lg">
                <div class="collapsible-header bg-yellow-100" onclick="toggleCollapse('contentBackup', 'iconBackup')">
                    <h2 class="text-xl font-bold text-yellow-700 flex items-center gap-3">
                        <i class="fa-solid fa-database"></i> Cloud Data Management
                    </h2>
                    <i id="iconBackup" class="fa-solid fa-caret-right text-yellow-700"></i>
                </div>
                <div id="contentBackup" class="p-6 pt-0 space-y-4 hidden">
                    <p class="text-yellow-600 mb-4">Your data is automatically saved to the cloud. Use this to manually download your General Resources data as a backup.</p>
                    
                    <div class="flex gap-4">
                        <button id="backupGeneralDataBtn" class="flex-1 p-3 bg-yellow-600 text-white font-semibold rounded-lg hover:bg-yellow-700 transition shadow-md" disabled>
                            <i class="fa-solid fa-download mr-2"></i> Download General Resources Backup (.json)
                        </button>
                        <input type="file" id="restoreFile" accept=".json" class="hidden">
                        <button id="restoreGeneralDataBtn" class="flex-1 p-3 bg-yellow-500 text-white font-semibold rounded-lg hover:bg-yellow-600 transition shadow-md" disabled>
                            <i class="fa-solid fa-upload mr-2"></i> Restore General Resources
                        </button>
                    </div>
                    <p id="restoreMessage" class="mt-4 text-center font-semibold hidden"></p>
                </div>
            </div>

        </div>

        <!-- Resources View Tab -->
        <div id="contentFiles" class="hidden space-y-8">
            
            <div class="p-4 bg-indigo-50 border border-indigo-200 rounded-xl shadow-inner">
                <h2 class="text-xl font-bold text-indigo-700 mb-3 flex items-center gap-2">
                    <i class="fa-solid fa-folder-open"></i> General Resources (Text & Files)
                </h2>
                <div id="generalResourcesList" class="space-y-3">
                    <p class="text-gray-500 italic p-2 text-center">Loading general resources...</p>
                </div>
            </div>
            
            <div class="p-4 bg-gray-50 border rounded-xl shadow-inner">
                <h2 class="text-xl font-bold text-gray-700 mb-3 flex items-center gap-2">
                    <i class="fa-solid fa-file-pdf"></i> Lesson Attachments (Curriculum Linked Files)
                </h2>
                <div id="uploadedFilesList" class="space-y-3">
                    <p class="text-gray-500 italic p-2 text-center">Lesson attachments will appear here once curriculum data is loaded.</p>
                </div>
            </div>

        </div>

    </div>
    
    <!-- Firebase Modular SDK Imports & App Logic -->
    <script type="module">
        // Full script as in your original code (Firebase init, real-time listeners, drag-drop, import, backup/restore, UI rendering)
        // For brevity, you can directly reuse the script you provided above here.
    </script>
</body>
</html>