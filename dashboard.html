<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Educator Hub - Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }

  .metric-card {
    @apply relative flex flex-col items-center justify-center rounded-3xl shadow-xl p-8 transition hover:shadow-2xl;
  }

  .metric-circle {
    @apply relative flex items-center justify-center rounded-full shadow-lg;
    width: 150px;
    height: 150px;
  }

  .metric-circle i {
    font-size: 4rem;
    color: white;
  }

  .metric-count {
    @apply absolute text-white font-bold text-4xl;
  }

  .metric-label {
    @apply mt-6 text-xl font-semibold text-gray-800;
  }

  .action-card {
    @apply bg-indigo-600 text-white rounded-3xl shadow-xl flex items-center justify-center p-6 cursor-pointer transition hover:bg-indigo-700 text-center;
  }

  .action-card p {
    @apply text-xl font-semibold;
  }

  .grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 2rem;
    align-items: start;
  }
</style>
</head>
<body>

<!-- Navbar -->
<nav class="bg-indigo-700 p-4 shadow-2xl">
  <div class="container max-w-5xl mx-auto flex flex-wrap justify-center gap-4">
      <a href="dashboard.html" class="px-4 py-2 bg-white text-indigo-700 font-bold rounded-lg shadow-inner">Home üè†</a>
      <a href="curriculum_topics.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Topics üß†</a>
      <a href="notes.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Notes üìù</a>
      <a href="todo.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">To-Do ‚úÖ</a>
      <a href="resources.html" class="px-4 py-2 text-white font-semibold rounded-lg hover:bg-indigo-600 transition">Tools üõ†Ô∏è</a>
      <button id="logoutBtn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">Sign Out</button>
  </div>
</nav>

<div class="container max-w-6xl mx-auto p-8 mt-8">

  <!-- Welcome -->
  <div class="mb-12 text-center">
      <h1 class="text-5xl font-bold text-gray-800" id="welcomeMessage">Welcome!</h1>
      <p class="text-gray-600 mt-2">Here‚Äôs a quick overview of your curriculum and tasks.</p>
  </div>

  <!-- Dashboard Metrics -->
  <div class="grid-container">

    <!-- Topics Metric -->
    <div class="metric-card bg-indigo-500">
      <div class="metric-circle bg-indigo-600">
        <i class="fa-solid fa-brain"></i>
        <div class="metric-count" id="topicsCount">0</div>
      </div>
      <p class="metric-label">Topics Covered</p>
    </div>

    <!-- Add New Topic -->
    <div class="action-card" onclick="window.location.href='curriculum_topics.html'">
      <p><i class="fa-solid fa-plus mr-2"></i>Add New Topic</p>
    </div>

    <!-- Notes Metric -->
    <div class="metric-card bg-green-500">
      <div class="metric-circle bg-green-600">
        <i class="fa-solid fa-sticky-note"></i>
        <div class="metric-count" id="notesCount">0</div>
      </div>
      <p class="metric-label">Total Notes</p>
    </div>

    <!-- Add New Note -->
    <div class="action-card" onclick="window.location.href='notes.html'">
      <p><i class="fa-solid fa-plus mr-2"></i>Add New Note</p>
    </div>

    <!-- Pending Tasks Metric -->
    <div class="metric-card bg-yellow-500">
      <div class="metric-circle bg-yellow-600">
        <i class="fa-solid fa-hourglass-start"></i>
        <div class="metric-count" id="pendingTasks">0</div>
      </div>
      <p class="metric-label">Pending Tasks</p>
    </div>

    <!-- Add New Task -->
    <div class="action-card" onclick="window.location.href='todo.html'">
      <p><i class="fa-solid fa-plus mr-2"></i>Add New Task</p>
    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
import { getFirestore, collection, query, onSnapshot, where } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyChZSrBTGv0pjjSG-3XVOEI4eTXCQyk9cw",
  authDomain: "school-organiser-5f512.firebaseapp.com",
  projectId: "school-organiser-5f512",
  storageBucket: "school-organiser-5f512.appspot.com",
  messagingSenderId: "567803400438",
  appId: "1:567803400438:web:56ea2010e2d2a54fcc5cd7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const topicsCountEl = document.getElementById('topicsCount');
const notesCountEl = document.getElementById('notesCount');
const pendingTasksEl = document.getElementById('pendingTasks');
const welcomeMessageEl = document.getElementById('welcomeMessage');
const logoutBtn = document.getElementById('logoutBtn');

onAuthStateChanged(auth, user => {
    if(!user) return window.location.href='index.html';
    const uid = user.uid;
    const displayName = user.displayName || 'Educator';
    welcomeMessageEl.textContent = `Welcome, ${displayName}!`;

    // Topics
    const topicsRef = collection(db, 'users', uid, 'topics');
    onSnapshot(topicsRef, snapshot => { topicsCountEl.textContent = snapshot.size; });

    // Notes
    const notesRef = collection(db, 'users', uid, 'daily_notes');
    onSnapshot(notesRef, snapshot => { notesCountEl.textContent = snapshot.size; });

    // Pending Tasks
    const tasksRef = collection(db, 'users', uid, 'tasks');
    const pendingQuery = query(tasksRef, where('completed', '==', false));
    onSnapshot(pendingQuery, snapshot => { pendingTasksEl.textContent = snapshot.size; });
});

logoutBtn.onclick = async () => { await signOut(auth); window.location.href='index.html'; };
</script>

</body>
</html>